{"version":3,"sources":["components/tokens/List.module.scss","components/LineEdit.module.scss","components/tokens/ListItem.module.scss","state.js","components/LineEdit.js","components/Term.js","components/tokens/ListItem.js","components/tokens/List.js","components/Page.js","components/App.js","index.js"],"names":["module","exports","CallbackContext","createContext","parser","create","initialState","pages","currentPage","focusedPath","methods","draft","addPage","markdown","page","ast","tokenizeBlock","Page","push","length","deindent","path","console","log","indent","setValue","value","reduce","a","b","children","getItem","useAppState","useMethods","itemSel","listItemStyles","ListItem","focusSibling","el","dir","target","item","closest","sibling","parentNode","findSibling","querySelector","styles","textarea","focus","keyHandlers","ArrowUp","_","ArrowDown","Tab","shiftKey","Enter","React","memo","rawPath","type","split","callbacks","useContext","ref","createRef","className","clsx","LineEdit","onChange","onKeyDown","event","key","current","preventDefault","rows","map","i","result","newPath","List","App","state","useEffect","axios","then","data","Provider","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.0162ec9a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"List\":\"List_List__3GKlr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"LineEdit\":\"LineEdit_LineEdit__1pxDD\",\"term\":\"LineEdit_term__1dMQr\",\"textarea\":\"LineEdit_textarea__evLCq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ListItem\":\"ListItem_ListItem__3nSas\"};","import { createContext, useContext } from \"react\";\nimport { create } from \"md-mdast\";\nimport useMethods from \"use-methods\";\n\nexport const CallbackContext = createContext();\n\nconst parser = create();\n\nconst Page = ({ markdown }) => ({\n  markdown,\n  ast: parser.tokenizeBlock(markdown)\n});\n\nconst initialState = {\n  pages: [],\n  currentPage: null,\n  focusedPath: null\n};\n\nconst getItem = (ast, path) => path.reduce((a, b) => a.children[b], ast);\n\n// eslint-disable-next-line no-unused-vars\nconst d = x => JSON.parse(JSON.stringify(x));\n\nconst methods = {\n  methods: draft => ({\n    addPage(markdown) {\n      const page = Page({\n        markdown\n      });\n      draft.pages.push(page);\n      draft.currentPage = draft.pages.length - 1;\n    },\n    deindent(path) {\n      console.log(path);\n    },\n    indent(path) {\n      console.log(path);\n    },\n    setValue(path, value) {\n      const item = getItem(draft.pages[draft.currentPage].ast, path);\n      item.children[0].value = value;\n    }\n  })\n};\n\nexport const useAppState = () => useMethods(methods, initialState);\n\nexport const useCallbackContext = () => useContext(CallbackContext);\n","import React from \"react\";\nimport styles from \"./LineEdit.module.scss\";\nimport listItemStyles from \"./tokens/ListItem.module.scss\";\nimport { useCallbackContext } from \"../state\";\nimport clsx from \"clsx\";\n\nconst itemSel = `.${listItemStyles.ListItem}`;\nconst findSibling = (el, dir) => {\n  if (!el) {\n    return;\n  }\n  const item = el.closest(itemSel);\n  const sibling = item[`${dir}Sibling`];\n  if (!sibling) {\n    return item.parentNode.closest(itemSel);\n  }\n  return sibling;\n};\nconst focusSibling = (el, dir) => {\n  const target = findSibling(el, dir);\n  if (!target) {\n    return;\n  }\n  target.querySelector(`.${styles.textarea}`).focus();\n};\nconst keyHandlers = {\n  ArrowUp(_, el) {\n    focusSibling(el, \"previous\");\n  },\n  ArrowDown(_, el) {\n    focusSibling(el, \"next\");\n  },\n  Tab({ shiftKey }, _, { indent, deindent }, path) {\n    if (shiftKey) {\n      deindent(path);\n    } else {\n      indent(path);\n    }\n  },\n  Enter({ shiftKey }, el) {\n    if (shiftKey) {\n      return true;\n    }\n  }\n};\n\nconst LineEdit = ({ path: rawPath, type, ast }) => {\n  const path = rawPath.split(\".\");\n  const callbacks = useCallbackContext();\n  const ref = React.createRef();\n\n  const handleChange = ({ target: { value } }) => {\n    callbacks.setValue(path, value);\n  };\n  const handleKeyDown = event => {\n    const { key } = event;\n\n    if (keyHandlers[key]) {\n      const unhandled = keyHandlers[key](event, ref.current, callbacks, path);\n      if (!unhandled) {\n        event.preventDefault();\n      }\n    }\n  };\n\n  return (\n    <div className={clsx(styles[type], styles.LineEdit)}>\n      <textarea\n        onChange={handleChange}\n        onKeyDown={handleKeyDown}\n        className={styles.textarea}\n        rows={ast.value.split(\"\\n\").length}\n        value={ast.value}\n        ref={ref}\n      />\n    </div>\n  );\n};\n\nexport default React.memo(LineEdit);\n","import React from \"react\";\nimport LineEdit from \"./LineEdit\";\n\nconst Term = ({ ast, path }) => {\n  return (\n    <div>\n      <LineEdit path={path} type=\"term\" ast={ast.children[0]} />\n    </div>\n  );\n};\n\nexport default React.memo(Term);\n","import React from \"react\";\nimport List from \"./List\";\nimport Term from \"../Term\";\nimport LineEdit from \"../LineEdit\";\nimport styles from \"./ListItem.module.scss\";\n\nconst ListItem = ({ ast: { type, children }, path = \"\" }) => {\n  return (\n    <div className={styles.ListItem}>\n      {children.map((item, i) => {\n        let result;\n        const newPath = `${path}.${i}`;\n        if (item.type === \"list\") {\n          result = <List path={newPath} ast={item} />;\n        } else if (item.type === \"heading\") {\n          result = <Term path={newPath} ast={item} />;\n        } else if (item.type === \"paragraph\") {\n          result = (\n            <LineEdit path={newPath} type={item.type} ast={item.children[0]} />\n          );\n        } else {\n          result = item.type;\n        }\n\n        return <div key={i}>{result}</div>;\n      })}\n    </div>\n  );\n};\n\nexport default React.memo(ListItem);\n","import React from \"react\";\nimport ListItem from \"./ListItem\";\nimport styles from \"./List.module.scss\";\n\nconst List = ({ ast: { type, children }, path = \"0\" }) => {\n  return (\n    <div className={styles.List}>\n      {children.map((item, i) => {\n        return <ListItem path={`${path}.${i}`} ast={item} key={i} />;\n      })}\n    </div>\n  );\n};\n\nexport default React.memo(List);\n","import React from \"react\";\nimport List from \"./tokens/List\";\n\nconst Page = ({ ast }) => {\n  return (\n    <div>\n      <List ast={ast.children[0]} />\n    </div>\n  );\n};\n\nexport default React.memo(Page);\n","import React, { useEffect } from \"react\";\nimport styles from \"./App.module.scss\";\nimport Page from \"./Page\";\nimport { useAppState, CallbackContext } from \"../state\";\nimport axios from \"axios\";\n\nfunction App() {\n  const [state, callbacks] = useAppState();\n\n  useEffect(() => {\n    axios(\"./data/example.md\").then(result => callbacks.addPage(result.data));\n  }, [callbacks]);\n\n  return (\n    <CallbackContext.Provider value={callbacks}>\n      <div className={styles.App}>\n        {state.pages.map((page, i) => (\n          <div key={i}>\n            <h2>page {i + 1}</h2>\n            <Page {...page} />\n          </div>\n        ))}\n      </div>\n    </CallbackContext.Provider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./components/App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}